# Web Shield 18+ - Project Documentation

## 1. Overview
**Web Shield 18+** is a Chrome Extension (Manifest V3) designed to block explicit content and protect users from harmful websites. It combines static domain filtering with advanced client-side AI image analysis to ensure a safe browsing experience.

## 2. Key Features
*   **Static Blocking**: Utillizes Chrome's Declarative Net Request API to block known bad domains instantly.
*   **AI-Powered Image Analysis**:
    *   Uses **TensorFlow.js** with the **MobileNet V2** architecture.
    *   Runs entirely **Client-Side** (Offline) for privacy.
    *   **WASM Backend**: optimized for high performance (SIMD/Threaded support).
*   **Smart Blurring**: Automatically blurs images detected as Porn, Hentai, or Sexy based on user settings.
*   **Customizable Filters**:
    *   Toggle specific categories (Porn, Hentai, Sexy, Drawing, Neutral).
    *   Adjust sensitivity threshold (0-100%).
*   **Meme Theme**: Friendly "Cheems Police" branding to reduce stress when content is blocked.

## 3. Architecture

### Core Components
*   **Manifest V3**: Uses `declarativeNetRequest` for network blocking and Service Workers for background tasks.
*   **Content Script (`content.js`)**:
    *   Injects into all pages.
    *   Uses `IntersectionObserver` to lazy-load image scanning.
    *   Wraps blocked images with a container and overlay icon.
*   **AI Engine**:
    *   **Libraries**: Modular TensorFlow.js (Core, Layers, Converter, Backend-WASM).
    *   **Model**: Quantized MobileNet V2 stored locally in `extension/models/quantized/`.
*   **Storage**: Uses `chrome.storage.local` to persist user preferences (filters, threshold, active state).

### File Structure
```
extension/
├── manifest.json       # Extension Config
├── background.js       # Service Worker
├── content/
│   └── content.js      # Main AI Logic & DOM Manipulation
├── icons/              # Extension Icons (Cheems)
├── lib/                # Modular TFJS & WASM Binaries
├── models/             # Pre-trained Model Files
├── pages/              # Blocked Page & CSS
└── popup/              # UI for Settings & Rescan
```

## 4. Setup & Usage

### Prerequisites
*   Python 3.x (for downloading updated libraries).

### Installation
1.  Clone the repository.
2.  Run the dependency script to fetch the latest TFJS and WASM files:
    ```bash
    python update_libs.py
    ```
3.  Open Chrome and go to `chrome://extensions/`.
4.  Enable **Developer mode**.
5.  Click **Load unpacked** and select the `extension` folder.

### Configuration
*   Click the extension icon to open the Popup.
*   **Enable/Disable**: Toggle the main switch.
*   **Filter Settings**: Check/Uncheck categories (Porn, Hentai, Sexy, etc.).
*   **Sensitivity**: Drag the slider to adjust how strict the AI should be.
*   **Rescan**: Click "Save & Rescan Page" to apply changes immediately.

## 5. Resources & References
*   **TensorFlow.js**: [https://www.tensorflow.org/js](https://www.tensorflow.org/js)
*   **NSFWJS GitHub**: [https://github.com/infinitered/nsfwjs](https://github.com/infinitered/nsfwjs) - The inspiration and source for the classification model.
*   **Chrome Extension Documentation**: [https://developer.chrome.com/docs/extensions/mv3/](https://developer.chrome.com/docs/extensions/mv3/)

## 6. Known Issues
*   **CORS**: Some external images may be blocked by Cross-Origin policy if the server doesn't allow `Access-Control-Allow-Origin`. The extension attempts to use `crossOrigin = "anonymous"` but this is not guaranteed to work for all CDNs.
*   **Performance**: Very heavy pages with hundreds of images might still experience minor slowdowns despite WASM optimization.

---
*Documentation generated by Antigravity AI.*
